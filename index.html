<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Mini Hoop Shot Detector</title>
  <style>
    canvas.overlay { position:absolute; inset:0; width:100%; height:100%; background:transparent; }
    .calib-overlay{position:absolute; inset:0; display:none; align-items:center; justify-content:center; backdrop-filter:blur(0px); pointer-events:none}
  </style>
</head>
<body>
  <video id="video" playsinline muted></video>
  <canvas class="overlay" id="overlay"></canvas>
  <div class="calib-overlay" id="calibOverlay">
    <div class="calib-msg">Tap two points across the rim to set the detection line</div>
  </div>
  <button id="btnCalib">Calibrate rim line</button>

  <script>
    const overlay = document.getElementById('overlay');
    const calibOverlay = document.getElementById('calibOverlay');
    const btnCalib = document.getElementById('btnCalib');

    function startCalibration(){
      calibOverlay.classList.add('active');
      const points = [];
      function onTap(ev){
        const rect = overlay.getBoundingClientRect();
        const clientX = ev.touches ? ev.touches[0].clientX : ev.clientX;
        const clientY = ev.touches ? ev.touches[0].clientY : ev.clientY;
        const x = (clientX - rect.left) * (overlay.width/rect.width);
        const y = (clientY - rect.top) * (overlay.height/rect.height);
        points.push({x,y});
        console.log('Tap',x,y);
        if(points.length===2){
          calibOverlay.classList.remove('active');
          overlay.removeEventListener('click',onTap);
          overlay.removeEventListener('touchstart',onTap);
          alert('Calibration set!');
        }
      }
      overlay.addEventListener('click', onTap);
      overlay.addEventListener('touchstart', onTap, {passive:false});
    }

    btnCalib.addEventListener('click', startCalibration);
  </script>
</body>
</html>
